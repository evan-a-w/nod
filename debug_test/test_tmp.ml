open! Core
open! Import

let map_function_roots ~f functions =
  Map.map ~f:(Function.map_root ~f) functions
;;

let test_cfg s =
  s
  |> Parser.parse_string
  |> Result.map ~f:(map_function_roots ~f:Cfg.process)
  |> function
  | Error e -> Nod_error.to_string e |> print_endline
  | Ok fns ->
    Map.iter
      fns
      ~f:(fun { Function.root = ~root:_, ~blocks:_, ~in_order:blocks; _ } ->
        Vec.iter blocks ~f:(fun block ->
          let instrs =
            Vec.to_list block.Block.instructions @ [ block.terminal ]
          in
          print_s [%message block.id_hum (instrs : Ir.t list)]))
;;

let test_ssa ?don't_opt s =
  test_cfg s;
  print_endline "=================================";
  Parser.parse_string s
  |> Result.map ~f:(map_function_roots ~f:Cfg.process)
  |> Result.map ~f:Eir.set_entry_block_args
  |> Result.map ~f:(map_function_roots ~f:Ssa.create)
  |> function
  | Error e -> Nod_error.to_string e |> print_endline
  | Ok fns ->
    let go fns =
      Map.iter fns ~f:(fun { Function.root = (ssa : Ssa.t); _ } ->
        Vec.iter ssa.in_order ~f:(fun block ->
          let instrs = Vec.to_list block.instructions @ [ block.terminal ] in
          print_s
            [%message
              block.id_hum ~args:(block.args : Var.t Vec.t) (instrs : Ir.t list)]))
    in
    go fns;
    (match don't_opt with
     | Some () -> ()
     | None ->
       print_endline "******************************";
       Eir.optimize fns;
       go fns)
;;

let compile_and_lower ?(opt_flags = Eir.Opt_flags.no_opt) program =
  match Nod.compile ~opt_flags program with
  | Error e -> Nod_error.to_string e |> print_endline
  | Ok functions ->
    let asm = X86_backend.compile_to_asm functions in
    print_endline asm

let borked = Examples.Textual.f_but_simple

let%expect_test "borked" =
  compile_and_lower ~opt_flags:Eir.Opt_flags.no_opt borked;
  [%expect
    {|
    .intel_syntax noprefix
    .text
    .globl root
    root:
      push rbp
      push r12
      push r13
      push r14
      push r15
      mov rbp, rsp
      add rbp, 40
    root__start:
      mov r15, 7
      mov r14, 0
      mov r11, 0
    root__outercheck:
      mov r13, r14
      sub r13, r15
      cmp r13, 0
      je root__intermediate_outercheck_to_exit
    root__intermediate_outercheck_to_outerbody:
      jmp root__outerbody
    root__intermediate_outercheck_to_exit:
      jmp root__exit
    root__outerbody:
      mov r13, 0
      mov r12, 0
      mov r9, r13
      mov r10, r12
      jmp root__innercheck
    root__exit:
      mov rax, r11
    root__root__epilogue:
      mov rsp, rbp
      sub rsp, 40
      pop r15
      pop r14
      pop r13
      pop r12
      pop rbp
      ret
    root__innercheck:
      mov r10, r13
      sub r10, 3
      cmp r10, 0
      je root__intermediate_innercheck_to_innerexit
    root__intermediate_innercheck_to_innerbody:
      jmp root__innerbody
    root__intermediate_innercheck_to_innerexit:
      jmp root__innerexit
    root__innerbody:
      mov rax, r14
      imul r13
      mov r9, rax
      mov r10, r12
      add r10, r9
      mov r9, r13
      add r9, 1
      jmp root__innercheck
    root__innerexit:
      add r11, r12
    root__outerinc:
      add r14, 1
      mov r13, r12
      mov r12, r13
      jmp root__outercheck
    .section .note.GNU-stack,"",@progbits
    |}]
;;
(* FIXME: bug in innerbody ^ where r11 and r14 are mismatched somehow *)


let%expect_test "debug borked opt ssa" = test_ssa ~don't_opt:() borked;
  [%expect {|
    (start
     (instrs
      ((Move ((name n) (type_ I64)) (Lit 7))
       (Move ((name i) (type_ I64)) (Lit 0))
       (Move ((name total) (type_ I64)) (Lit 0))
       (Branch (Uncond ((block ((id_hum outerCheck) (args ()))) (args ())))))))
    (outerCheck
     (instrs
      ((Sub
        ((dest ((name condOuter) (type_ I64)))
         (src1 (Var ((name i) (type_ I64)))) (src2 (Var ((name n) (type_ I64))))))
       (Branch
        (Cond (cond (Var ((name condOuter) (type_ I64))))
         (if_true ((block ((id_hum outerBody) (args ()))) (args ())))
         (if_false ((block ((id_hum exit) (args ()))) (args ()))))))))
    (outerBody
     (instrs
      ((Move ((name j) (type_ I64)) (Lit 0))
       (Move ((name partial) (type_ I64)) (Lit 0))
       (Branch (Uncond ((block ((id_hum innerCheck) (args ()))) (args ())))))))
    (innerCheck
     (instrs
      ((Sub
        ((dest ((name condInner) (type_ I64)))
         (src1 (Var ((name j) (type_ I64)))) (src2 (Lit 3))))
       (Branch
        (Cond (cond (Var ((name condInner) (type_ I64))))
         (if_true ((block ((id_hum innerBody) (args ()))) (args ())))
         (if_false ((block ((id_hum innerExit) (args ()))) (args ()))))))))
    (innerBody
     (instrs
      ((Mul
        ((dest ((name tmp) (type_ I64))) (src1 (Var ((name i) (type_ I64))))
         (src2 (Var ((name j) (type_ I64))))))
       (Add
        ((dest ((name partial) (type_ I64)))
         (src1 (Var ((name partial) (type_ I64))))
         (src2 (Var ((name tmp) (type_ I64))))))
       (Add
        ((dest ((name j) (type_ I64))) (src1 (Var ((name j) (type_ I64))))
         (src2 (Lit 1))))
       (Branch (Uncond ((block ((id_hum innerCheck) (args ()))) (args ())))))))
    (innerExit
     (instrs
      ((Add
        ((dest ((name total) (type_ I64)))
         (src1 (Var ((name total) (type_ I64))))
         (src2 (Var ((name partial) (type_ I64))))))
       (Branch (Uncond ((block ((id_hum outerInc) (args ()))) (args ())))))))
    (outerInc
     (instrs
      ((Add
        ((dest ((name i) (type_ I64))) (src1 (Var ((name i) (type_ I64))))
         (src2 (Lit 1))))
       (Branch (Uncond ((block ((id_hum outerCheck) (args ()))) (args ())))))))
    (exit (instrs ((Return (Var ((name total) (type_ I64)))))))
    =================================
    (start (args ())
     (instrs
      ((Move ((name n) (type_ I64)) (Lit 7))
       (Move ((name i) (type_ I64)) (Lit 0))
       (Move ((name total) (type_ I64)) (Lit 0))
       (Branch
        (Uncond
         ((block
           ((id_hum outerCheck)
            (args
             (((name i%0) (type_ I64)) ((name total%0) (type_ I64))
              ((name j%0) (type_ I64)) ((name partial%0) (type_ I64))))))
          (args
           (((name i) (type_ I64)) ((name total) (type_ I64))
            ((name j) (type_ I64)) ((name partial) (type_ I64))))))))))
    (outerCheck
     (args
      (((name i%0) (type_ I64)) ((name total%0) (type_ I64))
       ((name j%0) (type_ I64)) ((name partial%0) (type_ I64))))
     (instrs
      ((Sub
        ((dest ((name condOuter) (type_ I64)))
         (src1 (Var ((name i%0) (type_ I64))))
         (src2 (Var ((name n) (type_ I64))))))
       (Branch
        (Cond (cond (Var ((name condOuter) (type_ I64))))
         (if_true ((block ((id_hum outerBody) (args ()))) (args ())))
         (if_false ((block ((id_hum exit) (args ()))) (args ()))))))))
    (outerBody (args ())
     (instrs
      ((Move ((name j%0) (type_ I64)) (Lit 0))
       (Move ((name partial%0) (type_ I64)) (Lit 0))
       (Branch
        (Uncond
         ((block
           ((id_hum innerCheck)
            (args (((name j%1) (type_ I64)) ((name partial%1) (type_ I64))))))
          (args (((name j%0) (type_ I64)) ((name partial%0) (type_ I64))))))))))
    (innerCheck (args (((name j%1) (type_ I64)) ((name partial%1) (type_ I64))))
     (instrs
      ((Sub
        ((dest ((name condInner) (type_ I64)))
         (src1 (Var ((name j%0) (type_ I64)))) (src2 (Lit 3))))
       (Branch
        (Cond (cond (Var ((name condInner) (type_ I64))))
         (if_true ((block ((id_hum innerBody) (args ()))) (args ())))
         (if_false ((block ((id_hum innerExit) (args ()))) (args ()))))))))
    (innerBody (args ())
     (instrs
      ((Mul
        ((dest ((name tmp) (type_ I64))) (src1 (Var ((name i%0) (type_ I64))))
         (src2 (Var ((name j%0) (type_ I64))))))
       (Add
        ((dest ((name partial%2) (type_ I64)))
         (src1 (Var ((name partial%0) (type_ I64))))
         (src2 (Var ((name tmp) (type_ I64))))))
       (Add
        ((dest ((name j%2) (type_ I64))) (src1 (Var ((name j%0) (type_ I64))))
         (src2 (Lit 1))))
       (Branch
        (Uncond
         ((block
           ((id_hum innerCheck)
            (args (((name j%1) (type_ I64)) ((name partial%1) (type_ I64))))))
          (args (((name j%2) (type_ I64)) ((name partial%2) (type_ I64))))))))))
    (innerExit (args ())
     (instrs
      ((Add
        ((dest ((name total%1) (type_ I64)))
         (src1 (Var ((name total%0) (type_ I64))))
         (src2 (Var ((name partial%0) (type_ I64))))))
       (Branch (Uncond ((block ((id_hum outerInc) (args ()))) (args ())))))))
    (outerInc (args ())
     (instrs
      ((Add
        ((dest ((name i%1) (type_ I64))) (src1 (Var ((name i%0) (type_ I64))))
         (src2 (Lit 1))))
       (Branch
        (Uncond
         ((block
           ((id_hum outerCheck)
            (args
             (((name i%0) (type_ I64)) ((name total%0) (type_ I64))
              ((name j%0) (type_ I64)) ((name partial%0) (type_ I64))))))
          (args
           (((name i%1) (type_ I64)) ((name total%1) (type_ I64))
            ((name j%0) (type_ I64)) ((name partial%0) (type_ I64))))))))))
    (exit (args ()) (instrs ((Return (Var ((name total%0) (type_ I64)))))))
    |}]


let%expect_test "debug borked" =
  match Nod.compile ~opt_flags:Eir.Opt_flags.no_opt borked with
  | Error e -> Nod_error.to_string e |> print_endline
  | Ok functions ->
    X86_backend.For_testing.print_selected_instructions functions;
    [%expect
      {|
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | block                                | instruction                                                                                                                                                                                                                                                                     | live_in                                                                                                                                                                           | live_out                                                                                                                                                                          |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | root__prologue                       | (block start(args()))                                                                                                                                                                                                                                                           | (((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                                                | (((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                                                |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | root__prologue                       | (X86(Tag_def NOOP(Reg((reg RBP)(class_ I64)))))                                                                                                                                                                                                                                 | (((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                                                | (((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                                                |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | root__prologue                       | (X86(JMP((block((id_hum start)(args())))(args()))))                                                                                                                                                                                                                             | (((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                                                | (((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                                                |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | root__prologue                       | block end                                                                                                                                                                                                                                                                       | (((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                                                | (((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                                                |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | start                                | (block start(args()))                                                                                                                                                                                                                                                           | (((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                                                | (((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                                                |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | start                                | (X86(MOV(Reg((reg(Unallocated((name n)(type_ I64))))(class_ I64)))(Imm 7)))                                                                                                                                                                                                     | (((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                                                | (((name n)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                           |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | start                                | (X86(MOV(Reg((reg(Unallocated((name i)(type_ I64))))(class_ I64)))(Imm 0)))                                                                                                                                                                                                     | (((name n)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                           | (((name n)(type_ I64))((name i)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                                                      |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | start                                | (X86(MOV(Reg((reg(Unallocated((name total)(type_ I64))))(class_ I64)))(Imm 0)))                                                                                                                                                                                                 | (((name n)(type_ I64))((name i)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                                                      | (((name n)(type_ I64))((name i)(type_ I64))((name total)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                             |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | start                                | (X86(MOV(Reg((reg(Unallocated((name i%0)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name i)(type_ I64))))(class_ I64)))))                                                                                                                                                | (((name n)(type_ I64))((name i)(type_ I64))((name total)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                             | (((name n)(type_ I64))((name i)(type_ I64))((name total)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                             |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | start                                | (X86(MOV(Reg((reg(Unallocated((name j%0)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name j)(type_ I64))))(class_ I64)))))                                                                                                                                                | (((name n)(type_ I64))((name i)(type_ I64))((name total)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                             | (((name n)(type_ I64))((name i)(type_ I64))((name total)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                             |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | start                                | (X86(MOV(Reg((reg(Unallocated((name partial%0)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name partial)(type_ I64))))(class_ I64)))))                                                                                                                                    | (((name n)(type_ I64))((name i)(type_ I64))((name total)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                             | (((name n)(type_ I64))((name i)(type_ I64))((name total)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                             |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | start                                | (X86(MOV(Reg((reg(Unallocated((name total%0)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name total)(type_ I64))))(class_ I64)))))                                                                                                                                        | (((name n)(type_ I64))((name i)(type_ I64))((name total)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                             | (((name n)(type_ I64))((name i)(type_ I64))((name total)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                             |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | start                                | (X86_terminal((JMP((block((id_hum outerCheck)(args(((name i%0)(type_ I64))((name total%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))))))(args(((name i)(type_ I64))((name total)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64))))))))         | (((name n)(type_ I64))((name i)(type_ I64))((name total)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                             | (((name n)(type_ I64)))                                                                                                                                                           |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | start                                | block end                                                                                                                                                                                                                                                                       | (((name n)(type_ I64)))                                                                                                                                                           | (((name n)(type_ I64)))                                                                                                                                                           |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerCheck                           | (block start(args(((name i%0)(type_ I64))((name total%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64)))))                                                                                                                                                     | (((name n)(type_ I64)))                                                                                                                                                           | (((name n)(type_ I64))((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerCheck                           | (X86(MOV(Reg((reg(Unallocated((name condOuter)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name i%0)(type_ I64))))(class_ I64)))))                                                                                                                                        | (((name n)(type_ I64))((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         | (((name n)(type_ I64))((name i%0)(type_ I64))((name total%0)(type_ I64))((name condOuter)(type_ I64)))                                                                            |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerCheck                           | (X86(SUB(Reg((reg(Unallocated((name condOuter)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name n)(type_ I64))))(class_ I64)))))                                                                                                                                          | (((name n)(type_ I64))((name i%0)(type_ I64))((name total%0)(type_ I64))((name condOuter)(type_ I64)))                                                                            | (((name n)(type_ I64))((name i%0)(type_ I64))((name total%0)(type_ I64))((name condOuter)(type_ I64)))                                                                            |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerCheck                           | (X86_terminal((CMP(Reg((reg(Unallocated((name condOuter)(type_ I64))))(class_ I64)))(Imm 0))(JNE((block((id_hum intermediate_outerCheck_to_outerBody)(args())))(args()))(((block((id_hum intermediate_outerCheck_to_exit)(args())))(args()))))))                                | (((name n)(type_ I64))((name i%0)(type_ I64))((name total%0)(type_ I64))((name condOuter)(type_ I64)))                                                                            | (((name n)(type_ I64))((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerCheck                           | block end                                                                                                                                                                                                                                                                       | (((name n)(type_ I64))((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         | (((name n)(type_ I64))((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_outerCheck_to_outerBody | (block start(args()))                                                                                                                                                                                                                                                           | (((name n)(type_ I64))((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         | (((name n)(type_ I64))((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_outerCheck_to_outerBody | (X86(JMP((block((id_hum outerBody)(args())))(args()))))                                                                                                                                                                                                                         | (((name n)(type_ I64))((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         | (((name n)(type_ I64))((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_outerCheck_to_outerBody | block end                                                                                                                                                                                                                                                                       | (((name n)(type_ I64))((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         | (((name n)(type_ I64))((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerBody                            | (block start(args()))                                                                                                                                                                                                                                                           | (((name n)(type_ I64))((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         | (((name n)(type_ I64))((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerBody                            | (X86(MOV(Reg((reg(Unallocated((name j%0)(type_ I64))))(class_ I64)))(Imm 0)))                                                                                                                                                                                                   | (((name n)(type_ I64))((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name total%0)(type_ I64)))                                                                                  |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerBody                            | (X86(MOV(Reg((reg(Unallocated((name partial%0)(type_ I64))))(class_ I64)))(Imm 0)))                                                                                                                                                                                             | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name total%0)(type_ I64)))                                                                                  | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerBody                            | (X86(MOV(Reg((reg(Unallocated((name j%1)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name j%0)(type_ I64))))(class_ I64)))))                                                                                                                                              | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerBody                            | (X86(MOV(Reg((reg(Unallocated((name partial%1)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name partial%0)(type_ I64))))(class_ I64)))))                                                                                                                                  | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerBody                            | (X86_terminal((JMP((block((id_hum innerCheck)(args(((name j%1)(type_ I64))((name partial%1)(type_ I64))))))(args(((name j%0)(type_ I64))((name partial%0)(type_ I64))))))))                                                                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerBody                            | block end                                                                                                                                                                                                                                                                       | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerCheck                           | (block start(args(((name j%1)(type_ I64))((name partial%1)(type_ I64)))))                                                                                                                                                                                                       | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerCheck                           | (X86(MOV(Reg((reg(Unallocated((name condInner)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name j%0)(type_ I64))))(class_ I64)))))                                                                                                                                        | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name condInner)(type_ I64)))                        |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerCheck                           | (X86(SUB(Reg((reg(Unallocated((name condInner)(type_ I64))))(class_ I64)))(Imm 3)))                                                                                                                                                                                             | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name condInner)(type_ I64)))                        | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name condInner)(type_ I64)))                        |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerCheck                           | (X86_terminal((CMP(Reg((reg(Unallocated((name condInner)(type_ I64))))(class_ I64)))(Imm 0))(JNE((block((id_hum intermediate_innerCheck_to_innerBody)(args())))(args()))(((block((id_hum intermediate_innerCheck_to_innerExit)(args())))(args()))))))                           | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name condInner)(type_ I64)))                        | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerCheck                           | block end                                                                                                                                                                                                                                                                       | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_innerCheck_to_innerBody | (block start(args()))                                                                                                                                                                                                                                                           | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_innerCheck_to_innerBody | (X86(JMP((block((id_hum innerBody)(args())))(args()))))                                                                                                                                                                                                                         | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_innerCheck_to_innerBody | block end                                                                                                                                                                                                                                                                       | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerBody                            | (block start(args()))                                                                                                                                                                                                                                                           | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerBody                            | (X86(MOV(Reg((reg(Allocated((name tmp_rax)(type_ I64))(RAX)))(class_ I64)))(Reg((reg(Unallocated((name i%0)(type_ I64))))(class_ I64)))))                                                                                                                                       | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name tmp_rax)(type_ I64)))                          |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerBody                            | (X86(Tag_def(Tag_use(IMUL(Reg((reg(Unallocated((name j%0)(type_ I64))))(class_ I64))))(Reg((reg(Allocated((name tmp_rax)(type_ I64))(RAX)))(class_ I64))))(Reg((reg(Allocated((name tmp_dst)(type_ I64))(RAX)))(class_ I64)))))                                                 | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name tmp_rax)(type_ I64)))                          | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name tmp_dst)(type_ I64)))                          |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerBody                            | (X86(MOV(Reg((reg(Unallocated((name tmp)(type_ I64))))(class_ I64)))(Reg((reg(Allocated((name tmp_dst)(type_ I64))(RAX)))(class_ I64)))))                                                                                                                                       | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name tmp_dst)(type_ I64)))                          | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name tmp)(type_ I64)))                              |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerBody                            | (X86(MOV(Reg((reg(Unallocated((name partial%2)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name partial%0)(type_ I64))))(class_ I64)))))                                                                                                                                  | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name tmp)(type_ I64)))                              | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name tmp)(type_ I64))((name partial%2)(type_ I64))) |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerBody                            | (X86(ADD(Reg((reg(Unallocated((name partial%2)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name tmp)(type_ I64))))(class_ I64)))))                                                                                                                                        | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name tmp)(type_ I64))((name partial%2)(type_ I64))) | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name partial%2)(type_ I64)))                        |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerBody                            | (X86(MOV(Reg((reg(Unallocated((name j%2)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name j%0)(type_ I64))))(class_ I64)))))                                                                                                                                              | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name partial%2)(type_ I64)))                        | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name partial%2)(type_ I64))((name j%2)(type_ I64))) |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerBody                            | (X86(ADD(Reg((reg(Unallocated((name j%2)(type_ I64))))(class_ I64)))(Imm 1)))                                                                                                                                                                                                   | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name partial%2)(type_ I64))((name j%2)(type_ I64))) | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name partial%2)(type_ I64))((name j%2)(type_ I64))) |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerBody                            | (X86(MOV(Reg((reg(Unallocated((name j%1)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name j%2)(type_ I64))))(class_ I64)))))                                                                                                                                              | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name partial%2)(type_ I64))((name j%2)(type_ I64))) | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name partial%2)(type_ I64))((name j%2)(type_ I64))) |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerBody                            | (X86(MOV(Reg((reg(Unallocated((name partial%1)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name partial%2)(type_ I64))))(class_ I64)))))                                                                                                                                  | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name partial%2)(type_ I64))((name j%2)(type_ I64))) | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name partial%2)(type_ I64))((name j%2)(type_ I64))) |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerBody                            | (X86_terminal((JMP((block((id_hum innerCheck)(args(((name j%1)(type_ I64))((name partial%1)(type_ I64))))))(args(((name j%2)(type_ I64))((name partial%2)(type_ I64))))))))                                                                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name partial%2)(type_ I64))((name j%2)(type_ I64))) | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerBody                            | block end                                                                                                                                                                                                                                                                       | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_innerCheck_to_innerExit | (block start(args()))                                                                                                                                                                                                                                                           | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_innerCheck_to_innerExit | (X86(JMP((block((id_hum innerExit)(args())))(args()))))                                                                                                                                                                                                                         | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_innerCheck_to_innerExit | block end                                                                                                                                                                                                                                                                       | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerExit                            | (block start(args()))                                                                                                                                                                                                                                                           | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerExit                            | (X86(MOV(Reg((reg(Unallocated((name total%1)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name total%0)(type_ I64))))(class_ I64)))))                                                                                                                                      | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerExit                            | (X86(ADD(Reg((reg(Unallocated((name total%1)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name partial%0)(type_ I64))))(class_ I64)))))                                                                                                                                    | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64)))                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerExit                            | (X86_terminal((JMP((block((id_hum outerInc)(args())))(args())))))                                                                                                                                                                                                               | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64)))                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerExit                            | block end                                                                                                                                                                                                                                                                       | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64)))                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerInc                             | (block start(args()))                                                                                                                                                                                                                                                           | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64)))                                                     | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerInc                             | (X86(MOV(Reg((reg(Unallocated((name i%1)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name i%0)(type_ I64))))(class_ I64)))))                                                                                                                                              | (((name n)(type_ I64))((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64)))                                                     | (((name n)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerInc                             | (X86(ADD(Reg((reg(Unallocated((name i%1)(type_ I64))))(class_ I64)))(Imm 1)))                                                                                                                                                                                                   | (((name n)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                                                     | (((name n)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerInc                             | (X86(MOV(Reg((reg(Unallocated((name i%0)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name i%1)(type_ I64))))(class_ I64)))))                                                                                                                                              | (((name n)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                                                     | (((name n)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerInc                             | (X86(MOV(Reg((reg(Unallocated((name total%0)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name total%1)(type_ I64))))(class_ I64)))))                                                                                                                                      | (((name n)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                                                     | (((name n)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerInc                             | (X86(MOV(Reg((reg(Unallocated((name regalloc_scratch)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name j%0)(type_ I64))))(class_ I64)))))                                                                                                                                 | (((name n)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                                                     | (((name n)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64))((name regalloc_scratch)(type_ I64)))                                        |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerInc                             | (X86(MOV(Reg((reg(Unallocated((name j%0)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name regalloc_scratch)(type_ I64))))(class_ I64)))))                                                                                                                                 | (((name n)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64))((name regalloc_scratch)(type_ I64)))                                        | (((name n)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerInc                             | (X86(MOV(Reg((reg(Unallocated((name regalloc_scratch0)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name partial%0)(type_ I64))))(class_ I64)))))                                                                                                                          | (((name n)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                                                     | (((name n)(type_ I64))((name j%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64))((name regalloc_scratch0)(type_ I64)))                                             |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerInc                             | (X86(MOV(Reg((reg(Unallocated((name partial%0)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name regalloc_scratch0)(type_ I64))))(class_ I64)))))                                                                                                                          | (((name n)(type_ I64))((name j%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64))((name regalloc_scratch0)(type_ I64)))                                             | (((name n)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerInc                             | (X86_terminal((JMP((block((id_hum outerCheck)(args(((name i%0)(type_ I64))((name total%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))))))(args(((name i%1)(type_ I64))((name total%1)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64)))))))) | (((name n)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                                                     | (((name n)(type_ I64)))                                                                                                                                                           |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerInc                             | block end                                                                                                                                                                                                                                                                       | (((name n)(type_ I64)))                                                                                                                                                           | (((name n)(type_ I64)))                                                                                                                                                           |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_outerCheck_to_exit      | (block start(args()))                                                                                                                                                                                                                                                           | (((name total%0)(type_ I64)))                                                                                                                                                     | (((name total%0)(type_ I64)))                                                                                                                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_outerCheck_to_exit      | (X86(JMP((block((id_hum exit)(args())))(args()))))                                                                                                                                                                                                                              | (((name total%0)(type_ I64)))                                                                                                                                                     | (((name total%0)(type_ I64)))                                                                                                                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_outerCheck_to_exit      | block end                                                                                                                                                                                                                                                                       | (((name total%0)(type_ I64)))                                                                                                                                                     | (((name total%0)(type_ I64)))                                                                                                                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | exit                                 | (block start(args()))                                                                                                                                                                                                                                                           | (((name total%0)(type_ I64)))                                                                                                                                                     | (((name total%0)(type_ I64)))                                                                                                                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | exit                                 | (X86(MOV(Reg((reg(Unallocated((name res__0)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name total%0)(type_ I64))))(class_ I64)))))                                                                                                                                       | (((name total%0)(type_ I64)))                                                                                                                                                     | (((name total%0)(type_ I64)))                                                                                                                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | exit                                 | (X86_terminal((JMP((block((id_hum root__epilogue)(args(((name res__0)(type_ I64))))))(args(((name total%0)(type_ I64))))))))                                                                                                                                                    | (((name total%0)(type_ I64)))                                                                                                                                                     | {}                                                                                                                                                                                |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | exit                                 | block end                                                                                                                                                                                                                                                                       | {}                                                                                                                                                                                | {}                                                                                                                                                                                |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | root__epilogue                       | (block start(args(((name res__0)(type_ I64)))))                                                                                                                                                                                                                                 | {}                                                                                                                                                                                | (((name res__0)(type_ I64)))                                                                                                                                                      |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | root__epilogue                       | (X86(MOV(Reg((reg RAX)(class_ I64)))(Reg((reg(Allocated((name res__0)(type_ I64))(RAX)))(class_ I64)))))                                                                                                                                                                        | (((name res__0)(type_ I64)))                                                                                                                                                      | (((name res__0)(type_ I64)))                                                                                                                                                      |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | root__epilogue                       | (X86(RET((Reg((reg(Allocated((name res__0)(type_ I64))(RAX)))(class_ I64))))))                                                                                                                                                                                                  | (((name res__0)(type_ I64)))                                                                                                                                                      | {}                                                                                                                                                                                |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | root__epilogue                       | block end                                                                                                                                                                                                                                                                       | {}                                                                                                                                                                                | {}                                                                                                                                                                                |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      |}]
;;


let%expect_test "debug borked opt" =
  match Nod.compile ~opt_flags:Eir.Opt_flags.default borked with
  | Error e -> Nod_error.to_string e |> print_endline
  | Ok functions ->
    X86_backend.For_testing.print_selected_instructions functions;
    [%expect
      {|
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | block                                | instruction                                                                                                                                                                                                                                                                     | live_in                                                                                                                                                      | live_out                                                                                                                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | root__prologue                       | (block start(args()))                                                                                                                                                                                                                                                           | (((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                           | (((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                           |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | root__prologue                       | (X86(Tag_def NOOP(Reg((reg RBP)(class_ I64)))))                                                                                                                                                                                                                                 | (((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                           | (((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                           |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | root__prologue                       | (X86(JMP((block((id_hum start)(args())))(args()))))                                                                                                                                                                                                                             | (((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                           | (((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                           |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | root__prologue                       | block end                                                                                                                                                                                                                                                                       | (((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                           | (((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                           |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | start                                | (block start(args()))                                                                                                                                                                                                                                                           | (((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                           | (((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                           |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | start                                | (X86(MOV(Reg((reg(Unallocated((name i)(type_ I64))))(class_ I64)))(Imm 0)))                                                                                                                                                                                                     | (((name j)(type_ I64))((name partial)(type_ I64)))                                                                                                           | (((name i)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                                                      |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | start                                | (X86(MOV(Reg((reg(Unallocated((name total)(type_ I64))))(class_ I64)))(Imm 0)))                                                                                                                                                                                                 | (((name i)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                                                      | (((name i)(type_ I64))((name total)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                             |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | start                                | (X86(MOV(Reg((reg(Unallocated((name i%0)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name i)(type_ I64))))(class_ I64)))))                                                                                                                                                | (((name i)(type_ I64))((name total)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                             | (((name i)(type_ I64))((name total)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                             |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | start                                | (X86(MOV(Reg((reg(Unallocated((name j%0)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name j)(type_ I64))))(class_ I64)))))                                                                                                                                                | (((name i)(type_ I64))((name total)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                             | (((name i)(type_ I64))((name total)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                             |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | start                                | (X86(MOV(Reg((reg(Unallocated((name partial%0)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name partial)(type_ I64))))(class_ I64)))))                                                                                                                                    | (((name i)(type_ I64))((name total)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                             | (((name i)(type_ I64))((name total)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                             |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | start                                | (X86(MOV(Reg((reg(Unallocated((name total%0)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name total)(type_ I64))))(class_ I64)))))                                                                                                                                        | (((name i)(type_ I64))((name total)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                             | (((name i)(type_ I64))((name total)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                             |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | start                                | (X86_terminal((JMP((block((id_hum outerCheck)(args(((name i%0)(type_ I64))((name total%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))))))(args(((name i)(type_ I64))((name total)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64))))))))         | (((name i)(type_ I64))((name total)(type_ I64))((name j)(type_ I64))((name partial)(type_ I64)))                                                             | {}                                                                                                                                                           |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | start                                | block end                                                                                                                                                                                                                                                                       | {}                                                                                                                                                           | {}                                                                                                                                                           |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerCheck                           | (block start(args(((name i%0)(type_ I64))((name total%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64)))))                                                                                                                                                     | {}                                                                                                                                                           | (((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerCheck                           | (X86(MOV(Reg((reg(Unallocated((name condOuter)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name i%0)(type_ I64))))(class_ I64)))))                                                                                                                                        | (((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         | (((name i%0)(type_ I64))((name total%0)(type_ I64))((name condOuter)(type_ I64)))                                                                            |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerCheck                           | (X86(SUB(Reg((reg(Unallocated((name condOuter)(type_ I64))))(class_ I64)))(Imm 7)))                                                                                                                                                                                             | (((name i%0)(type_ I64))((name total%0)(type_ I64))((name condOuter)(type_ I64)))                                                                            | (((name i%0)(type_ I64))((name total%0)(type_ I64))((name condOuter)(type_ I64)))                                                                            |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerCheck                           | (X86_terminal((CMP(Reg((reg(Unallocated((name condOuter)(type_ I64))))(class_ I64)))(Imm 0))(JNE((block((id_hum intermediate_outerCheck_to_outerBody)(args())))(args()))(((block((id_hum intermediate_outerCheck_to_exit)(args())))(args()))))))                                | (((name i%0)(type_ I64))((name total%0)(type_ I64))((name condOuter)(type_ I64)))                                                                            | (((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerCheck                           | block end                                                                                                                                                                                                                                                                       | (((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         | (((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_outerCheck_to_outerBody | (block start(args()))                                                                                                                                                                                                                                                           | (((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         | (((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_outerCheck_to_outerBody | (X86(JMP((block((id_hum outerBody)(args())))(args()))))                                                                                                                                                                                                                         | (((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         | (((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_outerCheck_to_outerBody | block end                                                                                                                                                                                                                                                                       | (((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         | (((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerBody                            | (block start(args()))                                                                                                                                                                                                                                                           | (((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         | (((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerBody                            | (X86(MOV(Reg((reg(Unallocated((name j%0)(type_ I64))))(class_ I64)))(Imm 0)))                                                                                                                                                                                                   | (((name i%0)(type_ I64))((name total%0)(type_ I64)))                                                                                                         | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name total%0)(type_ I64)))                                                                                  |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerBody                            | (X86(MOV(Reg((reg(Unallocated((name partial%0)(type_ I64))))(class_ I64)))(Imm 0)))                                                                                                                                                                                             | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name total%0)(type_ I64)))                                                                                  | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerBody                            | (X86_terminal((JMP((block((id_hum innerCheck)(args())))(args())))))                                                                                                                                                                                                             | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerBody                            | block end                                                                                                                                                                                                                                                                       | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerCheck                           | (block start(args()))                                                                                                                                                                                                                                                           | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerCheck                           | (X86(MOV(Reg((reg(Unallocated((name condInner)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name j%0)(type_ I64))))(class_ I64)))))                                                                                                                                        | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name condInner)(type_ I64)))                        |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerCheck                           | (X86(SUB(Reg((reg(Unallocated((name condInner)(type_ I64))))(class_ I64)))(Imm 3)))                                                                                                                                                                                             | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name condInner)(type_ I64)))                        | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name condInner)(type_ I64)))                        |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerCheck                           | (X86_terminal((CMP(Reg((reg(Unallocated((name condInner)(type_ I64))))(class_ I64)))(Imm 0))(JNE((block((id_hum intermediate_innerCheck_to_innerBody)(args())))(args()))(((block((id_hum intermediate_innerCheck_to_innerExit)(args())))(args()))))))                           | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name condInner)(type_ I64)))                        | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerCheck                           | block end                                                                                                                                                                                                                                                                       | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_innerCheck_to_innerBody | (block start(args()))                                                                                                                                                                                                                                                           | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_innerCheck_to_innerBody | (X86(JMP((block((id_hum innerBody)(args())))(args()))))                                                                                                                                                                                                                         | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_innerCheck_to_innerBody | block end                                                                                                                                                                                                                                                                       | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerBody                            | (block start(args()))                                                                                                                                                                                                                                                           | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerBody                            | (X86(MOV(Reg((reg(Allocated((name tmp_rax)(type_ I64))(RAX)))(class_ I64)))(Reg((reg(Unallocated((name i%0)(type_ I64))))(class_ I64)))))                                                                                                                                       | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name tmp_rax)(type_ I64)))                          |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerBody                            | (X86(Tag_def(Tag_use(IMUL(Reg((reg(Unallocated((name j%0)(type_ I64))))(class_ I64))))(Reg((reg(Allocated((name tmp_rax)(type_ I64))(RAX)))(class_ I64))))(Reg((reg(Allocated((name tmp_dst)(type_ I64))(RAX)))(class_ I64)))))                                                 | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name tmp_rax)(type_ I64)))                          | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name tmp_dst)(type_ I64)))                          |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerBody                            | (X86(MOV(Reg((reg(Unallocated((name tmp)(type_ I64))))(class_ I64)))(Reg((reg(Allocated((name tmp_dst)(type_ I64))(RAX)))(class_ I64)))))                                                                                                                                       | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name tmp_dst)(type_ I64)))                          | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name tmp)(type_ I64)))                              |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerBody                            | (X86(MOV(Reg((reg(Unallocated((name partial%2)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name partial%0)(type_ I64))))(class_ I64)))))                                                                                                                                  | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name tmp)(type_ I64)))                              | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name tmp)(type_ I64))((name partial%2)(type_ I64))) |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerBody                            | (X86(ADD(Reg((reg(Unallocated((name partial%2)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name tmp)(type_ I64))))(class_ I64)))))                                                                                                                                        | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name tmp)(type_ I64))((name partial%2)(type_ I64))) | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerBody                            | (X86(MOV(Reg((reg(Unallocated((name j%2)(type_ I64))))(class_ I64)))(Imm 1)))                                                                                                                                                                                                   | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name j%2)(type_ I64)))                              |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerBody                            | (X86(ADD(Reg((reg(Unallocated((name j%2)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name j%0)(type_ I64))))(class_ I64)))))                                                                                                                                              | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64))((name j%2)(type_ I64)))                              | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerBody                            | (X86_terminal((JMP((block((id_hum innerCheck)(args())))(args())))))                                                                                                                                                                                                             | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerBody                            | block end                                                                                                                                                                                                                                                                       | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_innerCheck_to_innerExit | (block start(args()))                                                                                                                                                                                                                                                           | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_innerCheck_to_innerExit | (X86(JMP((block((id_hum innerExit)(args())))(args()))))                                                                                                                                                                                                                         | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_innerCheck_to_innerExit | block end                                                                                                                                                                                                                                                                       | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerExit                            | (block start(args()))                                                                                                                                                                                                                                                           | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerExit                            | (X86(MOV(Reg((reg(Unallocated((name total%1)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name total%0)(type_ I64))))(class_ I64)))))                                                                                                                                      | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%0)(type_ I64)))                                                     | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerExit                            | (X86(ADD(Reg((reg(Unallocated((name total%1)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name partial%0)(type_ I64))))(class_ I64)))))                                                                                                                                    | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64)))                                                     | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerExit                            | (X86_terminal((JMP((block((id_hum outerInc)(args())))(args())))))                                                                                                                                                                                                               | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64)))                                                     | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | innerExit                            | block end                                                                                                                                                                                                                                                                       | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64)))                                                     | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerInc                             | (block start(args()))                                                                                                                                                                                                                                                           | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64)))                                                     | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerInc                             | (X86(MOV(Reg((reg(Unallocated((name i%1)(type_ I64))))(class_ I64)))(Imm 1)))                                                                                                                                                                                                   | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64)))                                                     | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                              |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerInc                             | (X86(ADD(Reg((reg(Unallocated((name i%1)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name i%0)(type_ I64))))(class_ I64)))))                                                                                                                                              | (((name i%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                              | (((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerInc                             | (X86(MOV(Reg((reg(Unallocated((name i%0)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name i%1)(type_ I64))))(class_ I64)))))                                                                                                                                              | (((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                                                     | (((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerInc                             | (X86(MOV(Reg((reg(Unallocated((name total%0)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name total%1)(type_ I64))))(class_ I64)))))                                                                                                                                      | (((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                                                     | (((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerInc                             | (X86(MOV(Reg((reg(Unallocated((name regalloc_scratch)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name j%0)(type_ I64))))(class_ I64)))))                                                                                                                                 | (((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                                                     | (((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64))((name regalloc_scratch)(type_ I64)))                                        |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerInc                             | (X86(MOV(Reg((reg(Unallocated((name j%0)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name regalloc_scratch)(type_ I64))))(class_ I64)))))                                                                                                                                 | (((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64))((name regalloc_scratch)(type_ I64)))                                        | (((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerInc                             | (X86(MOV(Reg((reg(Unallocated((name regalloc_scratch0)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name partial%0)(type_ I64))))(class_ I64)))))                                                                                                                          | (((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                                                     | (((name j%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64))((name regalloc_scratch0)(type_ I64)))                                             |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerInc                             | (X86(MOV(Reg((reg(Unallocated((name partial%0)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name regalloc_scratch0)(type_ I64))))(class_ I64)))))                                                                                                                          | (((name j%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64))((name regalloc_scratch0)(type_ I64)))                                             | (((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                                                     |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerInc                             | (X86_terminal((JMP((block((id_hum outerCheck)(args(((name i%0)(type_ I64))((name total%0)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64))))))(args(((name i%1)(type_ I64))((name total%1)(type_ I64))((name j%0)(type_ I64))((name partial%0)(type_ I64)))))))) | (((name j%0)(type_ I64))((name partial%0)(type_ I64))((name total%1)(type_ I64))((name i%1)(type_ I64)))                                                     | {}                                                                                                                                                           |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | outerInc                             | block end                                                                                                                                                                                                                                                                       | {}                                                                                                                                                           | {}                                                                                                                                                           |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_outerCheck_to_exit      | (block start(args()))                                                                                                                                                                                                                                                           | (((name total%0)(type_ I64)))                                                                                                                                | (((name total%0)(type_ I64)))                                                                                                                                |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_outerCheck_to_exit      | (X86(JMP((block((id_hum exit)(args())))(args()))))                                                                                                                                                                                                                              | (((name total%0)(type_ I64)))                                                                                                                                | (((name total%0)(type_ I64)))                                                                                                                                |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | intermediate_outerCheck_to_exit      | block end                                                                                                                                                                                                                                                                       | (((name total%0)(type_ I64)))                                                                                                                                | (((name total%0)(type_ I64)))                                                                                                                                |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | exit                                 | (block start(args()))                                                                                                                                                                                                                                                           | (((name total%0)(type_ I64)))                                                                                                                                | (((name total%0)(type_ I64)))                                                                                                                                |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | exit                                 | (X86(MOV(Reg((reg(Unallocated((name res__0)(type_ I64))))(class_ I64)))(Reg((reg(Unallocated((name total%0)(type_ I64))))(class_ I64)))))                                                                                                                                       | (((name total%0)(type_ I64)))                                                                                                                                | (((name total%0)(type_ I64)))                                                                                                                                |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | exit                                 | (X86_terminal((JMP((block((id_hum root__epilogue)(args(((name res__0)(type_ I64))))))(args(((name total%0)(type_ I64))))))))                                                                                                                                                    | (((name total%0)(type_ I64)))                                                                                                                                | {}                                                                                                                                                           |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | exit                                 | block end                                                                                                                                                                                                                                                                       | {}                                                                                                                                                           | {}                                                                                                                                                           |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | root__epilogue                       | (block start(args(((name res__0)(type_ I64)))))                                                                                                                                                                                                                                 | {}                                                                                                                                                           | (((name res__0)(type_ I64)))                                                                                                                                 |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | root__epilogue                       | (X86(MOV(Reg((reg RAX)(class_ I64)))(Reg((reg(Allocated((name res__0)(type_ I64))(RAX)))(class_ I64)))))                                                                                                                                                                        | (((name res__0)(type_ I64)))                                                                                                                                 | (((name res__0)(type_ I64)))                                                                                                                                 |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | root__epilogue                       | (X86(RET((Reg((reg(Allocated((name res__0)(type_ I64))(RAX)))(class_ I64))))))                                                                                                                                                                                                  | (((name res__0)(type_ I64)))                                                                                                                                 | {}                                                                                                                                                           |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | root__epilogue                       | block end                                                                                                                                                                                                                                                                       | {}                                                                                                                                                           | {}                                                                                                                                                           |
      +--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
      |}]
;;
